Connect-MgGraph -Scopes "Application.ReadWrite.All"
$spId = $sp.Id
$spId

$job = Get-MgServicePrincipalSynchronizationJob -ServicePrincipalId $spId
$jobId = $job.Id
$jobId

# === CONFIG ===
$bearerToken = "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkdMbENlNUI5SXVBWThwYW1tdFVVSndHOXJCQWhoMnh2SGxieFR6Nm40TzAiLCJhbGciOiJSUzI1NiIsIng1dCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSIsImtpZCI6IkpZaEFjVFBNWl9MWDZEQmxPV1E3SG4wTmVYRSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvMmUxMTQzMDgtMTRlYy00ZDc3LWI2MTAtNDkwMzI0ZmExODQ0LyIsImlhdCI6MTc1NDAzNzQ3MSwibmJmIjoxNzU0MDM3NDcxLCJleHAiOjE3NTQwNDIxNDQsImFjY3QiOjAsImFjciI6IjEiLCJhY3JzIjpbInAxIiwidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iXSwiYWlvIjoiQVdRQW0vOFpBQUFBRjY2amVkRElkUDZKU21PaWxUWGczQzBLUDh2bmh1Z0hOZlFKemZlV28vN1FEQ05RUThiQm0xRUIxWlVCcFNRdUdocUZDWGhFMlBxTGFpRHJsQUxFYW1uZkUwb1c3cXNFTlhJZ0VmUjhWQVBxNVM1U1NVU2pMQ0djQWV1S3RiWDMiLCJhbXIiOlsicHdkIiwibWZhIl0sImFwcF9kaXNwbGF5bmFtZSI6IkFESWJpemFVWCIsImFwcGlkIjoiNzQ2NTgxMzYtMTRlYy00NjMwLWFkOWItMjZlMTYwZmYwZmM2IiwiYXBwaWRhY3IiOiIwIiwiY29udHJvbHMiOlsiY2FfZW5mIl0sImZhbWlseV9uYW1lIjoiQW5kZXJzZW4iLCJnaXZlbl9uYW1lIjoiSGFucyBDaHJpc3RpYW4iLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiI4NS4xOTEuMTIwLjE3OCIsIm5hbWUiOiIoQWRtaW4pIEhhbnMgQ2hyaXN0aWFuIEFuZGVyc2VuIChBcGVudG8pIiwib2lkIjoiNjlmZTI0NTgtZTBhMC00YWUyLWFiOWUtYmI5ZTA5YzRlZTIyIiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAzNUNGM0ZEOEEiLCJyaCI6IjEuQVhrQUNFTVJMdXdVZDAyMkVFa0RKUG9ZUkFNQUFBQUFBQUFBd0FBQUFBQUFBQUFNQVh4NUFBLiIsInNjcCI6IkFjY2Vzc1Jldmlldy5SZWFkV3JpdGUuQWxsIEFwcGxpY2F0aW9uLlJlYWQuQWxsIEF1ZGl0TG9nLlJlYWQuQWxsIENoYW5nZU1hbmFnZW1lbnQuUmVhZC5BbGwgQ29uc2VudFJlcXVlc3QuQ3JlYXRlIENvbnNlbnRSZXF1ZXN0LlJlYWQgQ29uc2VudFJlcXVlc3QuUmVhZEFwcHJvdmUuQWxsIENvbnNlbnRSZXF1ZXN0LlJlYWRXcml0ZS5BbGwgQ3VzdG9tU2VjQXR0cmlidXRlQXNzaWdubWVudC5SZWFkLkFsbCBDdXN0b21TZWNBdHRyaWJ1dGVBdWRpdExvZ3MuUmVhZC5BbGwgRGV2aWNlLU9yZ2FuaXphdGlvbmFsVW5pdC5SZWFkV3JpdGUuQWxsIERpcmVjdG9yeS5BY2Nlc3NBc1VzZXIuQWxsIERpcmVjdG9yeS5SZWFkLkFsbCBEaXJlY3RvcnkuUmVhZFdyaXRlLkFsbCBEaXJlY3RvcnkuV3JpdGUuUmVzdHJpY3RlZCBEaXJlY3RvcnlSZWNvbW1lbmRhdGlvbnMuUmVhZC5BbGwgRGlyZWN0b3J5UmVjb21tZW5kYXRpb25zLlJlYWRXcml0ZS5BbGwgRG9tYWluLlJlYWRXcml0ZS5BbGwgZW1haWwgRW50aXRsZW1lbnRNYW5hZ2VtZW50LlJlYWQuQWxsIEdyb3VwLlJlYWRXcml0ZS5BbGwgSGVhbHRoTW9uaXRvcmluZ0FsZXJ0LlJlYWRXcml0ZS5BbGwgSGVhbHRoTW9uaXRvcmluZ0FsZXJ0Q29uZmlnLlJlYWRXcml0ZS5BbGwgSWRlbnRpdHlQcm92aWRlci5SZWFkV3JpdGUuQWxsIElkZW50aXR5Umlza0V2ZW50LlJlYWRXcml0ZS5BbGwgSWRlbnRpdHlSaXNreVNlcnZpY2VQcmluY2lwYWwuUmVhZFdyaXRlLkFsbCBJZGVudGl0eVJpc2t5VXNlci5SZWFkV3JpdGUuQWxsIElkZW50aXR5VXNlckZsb3cuUmVhZC5BbGwgTGlmZWN5Y2xlV29ya2Zsb3dzLlJlYWRXcml0ZS5BbGwgT25QcmVtRGlyZWN0b3J5U3luY2hyb25pemF0aW9uLlJlYWQuQWxsIG9wZW5pZCBPcmdhbml6YXRpb25hbFVuaXQuUmVhZFdyaXRlLkFsbCBQb2xpY3kuUmVhZC5BbGwgUG9saWN5LlJlYWQuSWRlbnRpdHlQcm90ZWN0aW9uIFBvbGljeS5SZWFkV3JpdGUuQXV0aGVudGljYXRpb25GbG93cyBQb2xpY3kuUmVhZFdyaXRlLkF1dGhlbnRpY2F0aW9uTWV0aG9kIFBvbGljeS5SZWFkV3JpdGUuQXV0aG9yaXphdGlvbiBQb2xpY3kuUmVhZFdyaXRlLkNvbmRpdGlvbmFsQWNjZXNzIFBvbGljeS5SZWFkV3JpdGUuRXh0ZXJuYWxJZGVudGl0aWVzIFBvbGljeS5SZWFkV3JpdGUuSWRlbnRpdHlQcm90ZWN0aW9uIFBvbGljeS5SZWFkV3JpdGUuTW9iaWxpdHlNYW5hZ2VtZW50IHByb2ZpbGUgUmVwb3J0cy5SZWFkLkFsbCBSb2xlTWFuYWdlbWVudC5SZWFkV3JpdGUuRGlyZWN0b3J5IFNlY3VyaXR5RXZlbnRzLlJlYWRXcml0ZS5BbGwgVHJ1c3RGcmFtZXdvcmtLZXlTZXQuUmVhZC5BbGwgVXNlci5FeHBvcnQuQWxsIFVzZXIuUmVhZFdyaXRlLkFsbCBVc2VyQXV0aGVudGljYXRpb25NZXRob2QuUmVhZFdyaXRlLkFsbCBVc2VyLU9yZ2FuaXphdGlvbmFsVW5pdC5SZWFkV3JpdGUuQWxsIiwic2lkIjoiMDAyZTQzZDktNDNkYi03ZGMwLWMwMDgtYjQ3YjdjYTkzMGY4Iiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiV1ZCYUZxdGlhZTdWcGhweWVzQU1NbElQUGp2VjZ1OVh3bWlIbUh0ektSQSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6IjJlMTE0MzA4LTE0ZWMtNGQ3Ny1iNjEwLTQ5MDMyNGZhMTg0NCIsInVuaXF1ZV9uYW1lIjoiZXh0LmhhbnMuY2hyaXN0aWFuLmFuZGVyc2VuQFN0YXJrLmRrIiwidXBuIjoiZXh0LmhhbnMuY2hyaXN0aWFuLmFuZGVyc2VuQFN0YXJrLmRrIiwidXRpIjoiTU5NQmF4Q0RPMEdYd3ROQkNTLV9BQSIsInZlciI6IjEuMCIsIndpZHMiOlsiOWI4OTVkOTItMmNkMy00NGM3LTlkMDItYTZhYzJkNWVhNWMzIiwiMTk0YWU0Y2ItYjEyNi00MGIyLWJkNWItNjA5MWIzODA5NzdkIiwiM2EyYzYyZGItNTMxOC00MjBkLThkNzQtMjNhZmZlZTVkOWQ1IiwiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19mdGQiOiJ2dVNab3VRakNQLUxTZUUtN0pkUkV6UDJMN1pPOUg2LWlwcG5YWElNN3VZQmMzZGxaR1Z1WXkxa2MyMXoiLCJ4bXNfaWRyZWwiOiIxIDI0IiwieG1zX3N0Ijp7InN1YiI6Imtsc2dmUkJTWlpLYXQwdnR3WEhCc05oOHA3SnVmbVRxRkhXN2ZFejNQSGMifSwieG1zX3RjZHQiOjE0OTA5NTIxMTcsInhtc190ZGJyIjoiRVUifQ.mJQuS-FKSFVe-1ndW4GIe__JuhvbGM1SIaSJOE5mySGgiB5qAYKfGIxVT4Vcv7wIFvATjLlx8QcUanL0ts-9xk0P1GmEUiFjjH2ivDA29gHYeHNny8cyy7-DCNqI14nz0CV_qQASd1aCF_zcA5k9ptreXV0lUfqa8lkbrKwu6Jkv-_uTkSe4IqIxEPMcp98Ur9mpF-Joqwyq7PjKrjyW8vbJN45qNqQYsi3emIl271sL6UDLuDcMQZrLt8O1FFXNKZnueGE2TlK9XNKFiU1Xv2NNVaD7uYM3KsE6g25C6g29hjE9gluy2TVRaVDy3vfOlx0taz1SiZb04VUFizN1KA"  # Just the JWT, no 'Bearer'
$spId = "668c1901-2bd2-4957-9222-2db7a42d4894"     # Object ID from Enterprise App
$jobId = "WDAYoutAppDelta.2e11430814ec4d77b610490324fa1844.4f052227-ac61-40f4-b808-38a6c47e594e"                  # provisioningJob-...

# === API URL ===
$uri = "https://graph.microsoft.com/beta/servicePrincipals/$spId/synchronization/jobs/$jobId/restart"

# === Headers ===
$headers = @{
    "Authorization" = "Bearer $bearerToken"
    "Content-Type"  = "application/json"
}

# === JSON Body ===
$body = @{
    criteria = @{
        resetScope = "Full"
    }
} | ConvertTo-Json -Depth 5

# === POST the request ===
Invoke-RestMethod -Method POST -Uri $uri -Headers $headers -Body $body



https://graph.microsoft.com/beta/servicePrincipals/668c1901-2bd2-4957-9222-2db7a42d4894/synchronization/jobs/WDAYoutAppDelta.2e11430814ec4d77b610490324fa1844.4f052227-ac61-40f4-b808-38a6c47e594e